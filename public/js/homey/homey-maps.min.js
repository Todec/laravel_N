!function(e){"use strict";if("undefined"!=typeof HOMEY_map_vars){var a,t=HOMEY_map_vars.user_id,o=e("#listings_found"),n=HOMEY_map_vars.admin_url+"admin-ajax.php",i=HOMEY_map_vars.header_map_city,s=HOMEY_map_vars.markerPricePins,r=HOMEY_map_vars.pin_cluster,l=HOMEY_map_vars.pin_cluster_icon,m=HOMEY_map_vars.pin_cluster_zoom,p=HOMEY_map_vars.is_singular_listing,c=HOMEY_map_vars.homey_default_radius,d=0,g=new Array,u=e("#homey_halfmap_listings_container"),_=(new google.maps.InfoWindow,HOMEY_map_vars.google_map_style),v=HOMEY_map_vars.default_lat,f=HOMEY_map_vars.default_lng,h=HOMEY_map_vars.arrive,y=HOMEY_map_vars.depart,M=HOMEY_map_vars.guests,E=HOMEY_map_vars.pets,w=HOMEY_map_vars.search_country,O=HOMEY_map_vars.search_city,H=HOMEY_map_vars.search_area,Y=HOMEY_map_vars.listing_type,b=HOMEY_map_vars.country,k=HOMEY_map_vars.state,I=HOMEY_map_vars.city,x=HOMEY_map_vars.area,z=HOMEY_map_vars.start_time,B=HOMEY_map_vars.end_time,L=HOMEY_map_vars.min_price,T=HOMEY_map_vars.max_price,C=HOMEY_map_vars.keyword,P=HOMEY_map_vars.lat,S=HOMEY_map_vars.lng,D=HOMEY_map_vars.radius,R=HOMEY_map_vars.bedrooms,j=HOMEY_map_vars.rooms,A=HOMEY_map_vars.room_size,Z=(x=HOMEY_map_vars.area,HOMEY_map_vars.amenity),N=HOMEY_map_vars.facility,W=HOMEY_map_vars.not_found,G=HOMEY_map_vars.infoboxClose,U=HOMEY_map_vars.bedrooms_icon,V=HOMEY_map_vars.bathroom_icon,F=HOMEY_map_vars.guests_icon,J=e("#securityhomeyMap").val(),Q=0,q=HOMEY_ajax_vars.compare_url,K=HOMEY_ajax_vars.add_compare,X=HOMEY_ajax_vars.remove_compare,$=HOMEY_ajax_vars.compare_limit,ee=!1;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(ee=!0),""!=_)_=JSON.parse(_);if("yes"==s)var ae=-30;else ae=-70;var te=new InfoBox({maxWidth:300,alignBottom:!0,disableAutoPan:!1,pixelOffset:new google.maps.Size(-160,ae),zIndex:null,boxClass:"homeyInfobox",closeBoxMargin:"13px 2px -14px 2px",closeBoxURL:G,infoBoxClearance:new google.maps.Size(20,20),pane:"floatPane",enableEventPropagation:!1}),oe=function(e){if("yes"==r){var a=16;(m=parseInt(m))&&(a=m),new MarkerClusterer(e,g,{maxZoom:a,gridSize:60,styles:[{url:l,width:48,height:48,textColor:"#fff"}]})}},ne=function(e){google.maps.event.addDomListener(document.getElementById("listing-mapzoomin"),"click",function(){var a=parseInt(e.getZoom(),10);console.log(a),++a>20&&(a=20),console.log("== "+a+" ++"),e.setZoom(a)})},ie=function(e){google.maps.event.addDomListener(document.getElementById("listing-mapzoomout"),"click",function(){var a=parseInt(e.getZoom(),10);console.log(a),--a<0&&(a=0),console.log("== "+a+" -- "),e.setZoom(a)})};e(".homeyMapType").on("click",function(t){t.preventDefault();var o,n=e(this).data("maptype");"roadmap"===(o=n)?a.setMapTypeId(google.maps.MapTypeId.ROADMAP):"satellite"===o?a.setMapTypeId(google.maps.MapTypeId.SATELLITE):"hybrid"===o?a.setMapTypeId(google.maps.MapTypeId.HYBRID):"terrain"===o&&a.setMapTypeId(google.maps.MapTypeId.TERRAIN)});e("#homey-gmap-next").on("click",function(){!function(){for(++d>g.length&&(d=1);!1===g[d-1].visible;)++d>g.length&&(d=1);console.log(d-1),google.maps.event.trigger(g[d-1],"click")}()}),e("#homey-gmap-prev").on("click",function(){!function(){for(--d<1&&(d=g.length);!1===g[d-1].visible;)--d>g.length&&(d=1);console.log(d-1),google.maps.event.trigger(g[d-1],"click")}()});var se=function(e,a){var t=new google.maps.places.SearchBox(e);a.controls[google.maps.ControlPosition.TOP_LEFT].push(e),a.addListener("bounds_changed",function(){t.setBounds(a.getBounds())});var o=[];t.addListener("places_changed",function(){var e=t.getPlaces();if(0!=e.length){o.forEach(function(e){e.setMap(null)}),o=[];var n=new google.maps.LatLngBounds;e.forEach(function(e){var t={url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)};o.push(new google.maps.Marker({map:a,icon:t,title:e.name,position:e.geometry.location})),e.geometry.viewport?n.union(e.geometry.viewport):n.extend(e.geometry.location)}),a.fitBounds(n)}})},re=function(){for(var e=0;e<g.length;e++)g[e].setMap(null);g=[]},le=function(a,t){e.each(a,function(e,a){var o=new google.maps.LatLng(a.lat,a.long),n=a.data?a.data.post_title:a.title;if("yes"==s)var i='<div data-id="'+a.id+'" class="gm-marker gm-marker-color-'+a.term_id+'"><div class="gm-marker-price">'+a.price+"</div></div>",r=new RichMarker({map:t,position:o,draggable:!1,flat:!0,anchor:RichMarkerPosition.MIDDLE,content:i});else{var l=a.icon,m=new google.maps.Size(44,56);window.devicePixelRatio>1.5&&a.retinaIcon&&(l=a.retinaIcon,m=new google.maps.Size(44,56));var p={url:l,size:m,scaledSize:new google.maps.Size(44,56)};r=new google.maps.Marker({position:o,map:t,icon:p,draggable:!1,title:n})}var c="",d="",u="",_="";""!=a.bedrooms&&(c="<li>"+U+'<span class="total-beds">'+a.bedrooms+"</span></li>"),""!=a.baths&&(d="<li>"+V+'<span class="total-baths">'+a.baths+"</span></li>"),""!=a.guests&&(u="<li>"+F+'<span class="total-guests">'+a.guests+"</span></li>"),""!=a.listing_type&&(_='<li class="item-type">'+a.listing_type+"</li>");var v='<div id="google-maps-info-window"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+a.url+'" class="hover-effect">'+a.thumbnail+'</a><div class="item-media-price"><span class="item-price">'+a.price+'</span></div></div></div><div class="media-body item-body clearfix"><div class="item-title-head"><div class="title-head-left"><h2 class="title"><a href="'+a.url+'">'+n+'</a></h2><address class="item-address">'+a.address+'</address></div></div><ul class="item-amenities">'+c+d+u+_+"</ul></div></div></div></div>";google.maps.event.addListener(r,"click",function(e){te.setContent(v),te.open(t,this)}),g.push(r)})},me=function(s,r,l,m,c,d,h,y,M,E){if(null!=document.getElementById(l)){if(d||(d=14),!h)h=0;var w,O="";if(y?w="homey_half_map":(w="homey_header_map","lat_long"==E||"city"==E&&(O=i)),a=new google.maps.Map(document.getElementById(l),{zoom:d,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},center:new google.maps.LatLng(s,r),mapTypeId:"roadmap",gestureHandling:"cooperative",styles:_}),y)var H=M;else H={action:w,map_cities:O,security:J};google.maps.event.addListenerOnce(a,"idle",function(){b(n,H),Y()});var Y=function(){1==h&&google.maps.event.addListener(a,"dragend",function(){var e={action:w,map_cities:O,security:J,optimized_loading:1,north_east_lat:a.getBounds().getNorthEast().lat(),north_east_lng:a.getBounds().getNorthEast().lng(),south_west_lat:a.getBounds().getSouthWest().lat(),south_west_lng:a.getBounds().getSouthWest().lng()};b(n,e)})},b=function(n,i){e.ajax({url:n,dataType:"json",method:"POST",data:i,beforeSend:function(){e("#homey-map-loading").show(),y&&u.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(i){var s;!0===i.getListings?(re(),le(i.listings,a),y&&(u.empty().html(i.listingHtml),o.empty().html(i.total_results),ee||e(".infobox_trigger").each(function(a){e(this).on("mouseenter",function(){google.maps.event.trigger(g[a],"click")}),e(this).on("mouseleave",function(){te.open(null,null)})})),h||k(),oe(a),homey_init_add_favorite(n,t,p),homey_init_remove_favorite(n,t,p),s=homeyGetCookie("homey_compare_listings"),add_to_compare(q,K,X,$,s,4),remove_from_compare(s,K,X),y&&(ye(),e(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),e("#homey-map-loading").hide()):(re(),a.setCenter(new google.maps.LatLng(v,f)),e("#homey-halfmap").append('<div class="map-notfound">'+W+"</div>"),u.empty().html('<div class="map-notfound">'+W+"</div>"),o.empty().html(i.total_results))},error:function(e){console.log(e)}})},k=function(){a.fitBounds(g.reduce(function(e,a){return e.extend(a.getPosition())},new google.maps.LatLngBounds));var e=parseInt(a.getZoom(),10);e>20&&(e=14),a.setZoom(e)};if(document.getElementById("listing-mapzoomin")&&ne(a),document.getElementById("listing-mapzoomout")&&ie(a),document.getElementById("google-map-search")){var I=document.getElementById("google-map-search");se(I,a)}}else console.log("No map element found")},pe=function(a,t,o,n,i,s,r,l,m,p){var c=e("#homey-halfmap");h=a.find('input[name="arrive"]').val(),y=a.find('input[name="depart"]').val(),M=a.find('input[name="guest"]').val(),C=a.find('input[name="keyword"]').val(),E=a.find('input[name="pets"]:checked').val(),H=a.find('input[name="search_area"]').val(),O=a.find('input[name="search_city"]').val(),w=a.find('input[name="search_country"]').val(),P=a.find('input[name="lat"]').val(),S=a.find('input[name="lng"]').val(),D=a.find('input[name="radius"]').val(),Y=a.find('select[name="listing_type"]').val(),b=a.find('select[name="country"]').val(),k=a.find('select[name="state"]').val(),I=a.find('select[name="city"]').val(),x=a.find('select[name="area"]').val(),z=a.find('select[name="start"]').val(),B=a.find('select[name="end"]').val(),""!=Y&&null!=Y||(Y=c.data("type")),Z=a.find(".amenities-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),N=a.find(".facilities-list input[type=checkbox]:checked").map(function(a,t){return e(t).val()}).toArray(),L=a.find('select[name="min-price"]').val(),T=a.find('select[name="max-price"]').val(),R=a.find('select[name="bedrooms"]').val(),j=a.find('select[name="rooms"]').val(),A=a.find('select[name="room_size"]').val();var d=e("#sort_listings_halfmap").val();null!=t&&(Q=t);me(o,n,i,0,0,l,m,p,{action:"homey_half_map",arrive:h,depart:y,guest:M,keyword:C,pets:E,bedrooms:R,rooms:j,room_size:A,search_country:w,search_city:O,search_area:H,listing_type:Y,"min-price":L,"max-price":T,country:b,search_lat:P,search_lng:S,radius:D,state:k,city:I,area:x,start_hour:z,end_hour:B,amenity:Z,facility:N,sort_by:d,layout:ge,num_posts:ue,paged:t,security:J},"")};if(e("#banner-map").length>0){var ce=(be=e("#banner-map")).data("zoomlevel"),de=be.data("maptype");be.data("lat"),be.data("long");me(Oe="",He="",ke="banner-map",0,0,Ie=ce,he=0,fe=!1,null,de)}if(e("#homey-halfmap").length>0){ce=(be=e("#homey-halfmap")).data("zoom");var ge=be.data("layout"),ue=be.data("num-posts"),_e=be.data("order"),ve=be.data("type");""==Y&&(Y=ve);var fe,he;me(Oe="",He="",ke="homey-halfmap",0,0,Ie=ce,he=0,fe=!0,{action:"homey_half_map",arrive:h,depart:y,guest:M,keyword:C,pets:E,bedrooms:R,rooms:j,room_size:A,search_country:w,search_city:O,search_area:H,listing_type:Y,"min-price":L,"max-price":T,country:b,state:k,city:I,area:x,search_lat:P,search_lng:S,radius:D,start_hour:z,end_hour:B,amenity:Z,facility:N,layout:ge,num_posts:ue,sort_by:_e,paged:Q,security:J},de=""),e(".homey_half_map_search_btn").on("click",function(a){a.preventDefault();var t=e(this).parents(".half-map-wrap");pe(t,1,Oe,He,ke,0,0,Ie,he,fe)}),e("#sort_listings_halfmap").on("change",function(a){a.preventDefault();var t=e(this).parents(".half-map-wrap");pe(t,1,Oe,He,ke,0,0,Ie,he,fe)});var ye=function(){return e(".half_map_ajax_pagi a").on("click",function(a){a.preventDefault();var t=e(this).data("homeypagi"),o=e(this).parents(".half-map-wrap");pe(o,t,Oe,He,ke,0,0,Ie,he,fe)}),!1};e("#radius-range-slider").length>0&&(ze=c,e("#radius-range-slider").slider({value:ze,min:0,max:100,step:1,slide:function(a,t){e("#radius-range-text").html(t.value),e("#radius-range-value").val(t.value)},stop:function(a,t){var o=e(this).parents(".half-map-wrap");pe(o,1,Oe,He,ke,0,0,Ie,he,fe)}}),e("#radius-range-text").html(e("#radius-range-slider").slider("value")),e("#radius-range-value").val(e("#radius-range-slider").slider("value")))}if(e("#homey-single-map").length>0){ce=(be=e("#homey-single-map")).data("zoom");var Me=be.data("pin-type"),Ee=be.data("marker-pin"),we=be.data("marker-pin-retina"),Oe=be.data("lat"),He=be.data("long");if("marker"==Me)var Ye=!1;else Ye=!0;!function(e,t,o,n,i,s,r,l){var m;n||(n=!1),i||(i=!1),s||(s=15);var p=function(e){new google.maps.Circle({strokeColor:"#4f5962",strokeOpacity:.8,strokeWeight:2,fillColor:"#4f5962",fillOpacity:.35,map:e,center:m,radius:500})};!function(e){var t={zoom:s,center:e,disableDefaultUI:!1,gestureHandling:"cooperative",styles:_},n=document.getElementById(o);a=new google.maps.Map(n,t),i||function(e){var a=r,t=new google.maps.Size(44,56);window.devicePixelRatio>1.5&&l&&(a=l,t=new google.maps.Size(44,56));var o={url:a,size:t,scaledSize:new google.maps.Size(44,56)};new google.maps.Marker({position:e.getCenter(),map:e,icon:o,draggable:!1,animation:google.maps.Animation.DROP})}(a),i&&p(a)}(m=new google.maps.LatLng(e,t))}(Oe,He,ke="homey-single-map",!1,Ye,Ie=ce,Ee,we)}if(e("#homey_sticky_map").length>0){var be=e("#homey_sticky_map"),ke="homey_sticky_map",Ie=12,xe=be.data("mappaged");!function(t,o,i,s){if(null!=document.getElementById(t)){i||(i=14),a=new google.maps.Map(document.getElementById(t),{zoom:i,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,overviewMapControl:!1,scrollwheel:!1,fullscreenControl:!0,fullscreenControlOptions:{position:google.maps.ControlPosition.RIGHT_BOTTOM},center:new google.maps.LatLng("",""),mapTypeId:"roadmap",gestureHandling:"cooperative",styles:_});var r={action:"homey_sticky_map",paged:s,security:J};google.maps.event.addListenerOnce(a,"idle",function(){l(n,r)});var l=function(t,o){e.ajax({url:t,dataType:"json",method:"POST",data:o,success:function(t){!0===t.getListings&&(re(),le(t.listings,a),m(),oe(a),e("#homey-map-loading").hide())},error:function(e){console.log(e)}})},m=function(){a.fitBounds(g.reduce(function(e,a){return e.extend(a.getPosition())},new google.maps.LatLngBounds))};if(document.getElementById("listing-mapzoomin")&&ne(a),document.getElementById("listing-mapzoomout")&&ie(a),document.getElementById("google-map-search")){var p=document.getElementById("google-map-search");se(p,a)}}else console.log("No map element found")}(ke,0,Ie,xe)}e("#homey-gmap-full").on("click",function(){e('div.gm-style button[title="Toggle fullscreen view"]').trigger("click")})}var ze}(jQuery);